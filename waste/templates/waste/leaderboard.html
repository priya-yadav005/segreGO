{% extends 'waste/base.html' %}

{% block title %}Leaderboard - SegreGo{% endblock %}

{% block content %}
<div class="leaderboard-header">
    <div class="header-content">
        <h1 class="leaderboard-title">ğŸ† Community Leaderboard</h1>
        <p class="leaderboard-subtitle">Top households by points and segregation performance</p>
        <div class="leaderboard-stats">
            <div class="stat-item">
                <span class="stat-icon">ğŸ‘¥</span>
                <span class="stat-text">{{ households|length }} Households</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">â­</span>
                <span class="stat-text">Ranking Active</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">ğŸ¯</span>
                <span class="stat-text">Live Updates</span>
            </div>
        </div>
    </div>
</div>

<div class="table-container leaderboard-table">
    <table class="data-table">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Flat</th>
                <th>Resident</th>
                <th>Points</th>
                <th>Streak</th>
                <th>Segregation Score</th>
                <th>Tier</th>
            </tr>
        </thead>
        <tbody>
            {% for h in households %}
                <tr class="{% if forloop.counter <= 3 %}top-rank{% endif %}">
                    <td>
                        {% if forloop.counter == 1 %}
                            <span class="rank-badge gold">ğŸ¥‡ 1st</span>
                        {% elif forloop.counter == 2 %}
                            <span class="rank-badge silver">ğŸ¥ˆ 2nd</span>
                        {% elif forloop.counter == 3 %}
                            <span class="rank-badge bronze">ğŸ¥‰ 3rd</span>
                        {% else %}
                            <span class="rank-number">#{{ forloop.counter }}</span>
                        {% endif %}
                    </td>
                    <td><strong class="flat-badge">{{ h.flat_number }}</strong></td>
                    <td>{{ h.user.username }}</td>
                    <td><span class="badge badge-points">â­ {{ h.points }} pts</span></td>
                    <td><span class="badge badge-streak">ğŸ”¥ {{ h.consecutive_days }}d</span></td>
                    <td>
                        <span class="badge" style="{% if h.area_segregation_score >= 75 %}background: #dcfce7; color: #166534;{% elif h.area_segregation_score >= 50 %}background: #fef3c7; color: #92400e;{% else %}background: #fee2e2; color: #991b1b;{% endif %}">
                            {{ h.area_segregation_score }}%
                        </span>
                    </td>
                    <td>
                        {% if h.tier == 'Platinum' %}
                            <span class="badge tier-badge platinum">ğŸ’ {{ h.tier }}</span>
                        {% elif h.tier == 'Gold' %}
                            <span class="badge tier-badge gold-tier">â­ {{ h.tier }}</span>
                        {% elif h.tier == 'Silver' %}
                            <span class="badge tier-badge silver-tier">âœ¨ {{ h.tier }}</span>
                        {% else %}
                            <span class="badge tier-badge bronze-tier">ğŸ”· {{ h.tier }}</span>
                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="7" class="empty-cell">No households yet. Start submitting to join the leaderboard!</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
